# AI Instructions - Task Manager System

## Общая информация о проекте

Это backend приложение **Task Manager** - системы управления задачами и проектами, построенной на NestJS с TypeORM и PostgreSQL.

## Основная сфера деятельности

Task Manager - это корпоративная система для:
- Управления задачами и проектами
- Планирования рабочих процессов
- Контроля выполнения задач
- Аналитики производительности команд
- Управления пользователями и ролями в проектах

## Архитектурные принципы

### Технологический стек
- **Backend**: NestJS (Node.js)
- **Database**: PostgreSQL с TypeORM
- **Authentication**: JWT токены с HTTP-only cookies
- **API Documentation**: Swagger/OpenAPI
- **Package Manager**: pnpm

### Структура проекта
- `src/modules/` - бизнес-модули (auth, roles, exec)
- `src/entities/` - TypeORM сущности базы данных
- `src/common/` - общие компоненты (guards, decorators, middleware)
- `src/database/` - конфигурация БД и миграции

### Ключевые сущности
- **User** - пользователи системы
- **Role** - роли пользователей (admin, manager, developer, etc.)
- **Project** - проек��ы с задачами
- **Task** - задачи в проектах (предполагается)
- **TokenBlacklist** - заблокированные JWT токены

## Правила разработки

### Безопасность
1. Все эндпоинты требуют аутентификации через JwtAuthGuard
2. JWT токены передаются через HTTP-only cookies
3. Реализована система rate limiting для входа
4. Токены добавляются в blacklist при logout/refresh

### API Design
1. Используй Swagger декораторы для документации
2. Все ответы типизированы через DTO
3. Обработка ошибок через ErrorResponseDto
4. Валидация входящих данных через ValidationPipe

### База данных
1. Используй TypeORM entities в `src/entities/`
2. Миграции создавай в `src/database/migrations/`
3. UUID для всех primary keys
4. Soft delete для важных сущностей

### Структура модулей
```
module-name/
├── module-name.controller.ts
├── module-name.service.ts
├── module-name.module.ts
├── dto/
├── guards/
├── decorators/
└── interfaces/
```

## Контекст Task Manager

### Основные функции системы:
1. **Управление проектами** - создание, редактирование, архивирование
2. **Управление задачами** - создание, назначение, статусы, приоритеты
3. **Управление пользователями** - регистрация, роли, права доступа
4. **Отчетность** - аналитика по проектам и производительности
5. **Интеграции** - возможность интеграции с внешними системами

### Роли в системе:
- **Admin** - полный доступ к системе
- **Project Manager** - управление проектами и задачами
- **Developer** - работа с назначенными задачами
- **Viewer** - только просмотр

### Бизнес-логика:
- Проекты могут содержать множество задач
- Задачи имеют статусы: новая, в работе, на проверке, выполнена
- Пользователи могут быть назначены на несколько проектов
- Система логирования всех действий пользователей

## Рекомендации для разработки

1. **Всегда создавай DTO** для входящих и исходящих данных
2. **Используй guards** для проверки прав доступа
3. **Документируй API** через Swagger декораторы
4. **Валидируй данные** на уровне DTO с class-validator
5. **Логируй важные действия** пользователей
6. **Тестируй** критичную бизнес-логику

## Примеры использования

### Создание нового модуля
При добавлении нового модуля (например, tasks):
1. Создай entity в `src/entities/task.entity.ts`
2. Создай модуль в `src/modules/tasks/`
3. Добавь соответствующие DTO, guards, decorators
4. Зарегистрируй в app.module.ts

### Работа с аутентификацией
- Используй `@UseGuards(JwtAuthGuard)` для защищенных эндпоинтов
- Получай текущего пользователя через `@CurrentUser()` decorator
- Проверяй роли через `@UseGuards(RolesGuard)` и `@Roles()` decorator